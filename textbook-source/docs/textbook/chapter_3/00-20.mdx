---
title: If Statements and Endpoints
---
import * as Constants from '@site/src/constants'
import * as Components from '@site/src/components'

With if statements, we now have a way to make decisions. That is, our app can do one thing or another depending on the input it receives. This extends beyond just displaying `True` or `False` in our output. We can direct the flow of the program depending on how the user inputs certain information. 

## Why should we use if statements?

For example, you might want your app to perform a set of initial eligibility checks before proceeding with your main analysis. You might want to check for age or residency, because your app only applies to adults who are not pensioners or South Australian residents. These kinds of preliminary questions are good to resolve early in your processing flow. Otherwise, your user might have to run through the whole app to find out they should have never run it in the first place! Therefore, we can ask the user a few preliminary questions and, based on those questions, decide which path the application should take. 

## Using Flowcharts

Let's take a look at the following flowchart. We are going to be using flowcharts a lot to explain how applications work:

<Components.DisplayImage imageURL='/img/textbook/chapter_3/eligible_ineligible_flowchart.PNG' />

Let's look at this flowchart a bit more. We ask some initial eligibility questions. If these criteria are met, then we execute the rest of the program. Otherwise, we drop the user out - after explaining why, of course. 

## Turning our Flowchart into Docassemble Code

Now, this flowchart is *technology neutral*. That means we can use any programming language to implement this flow of control. However, what we are going to do now is implement this flow of control using Docassemble.

```yaml title="C3_01.yml" showLineNumbers
# Basic demonstration of using multiple endpoints for an interview
---
objects:
  - endpoint: DADict
---
# This is our welcome screen. We can choose to exit here 
# if we don't accept the disclaimer.
mandatory: True 
question: Welcome!
subquestion: |
  Welcome to our service (we don't know what it is yet). We hope you enjoy
  using it!

  ***Disclaimer:***
  **This advice is not to be taken as genuine legal advice and is not a substitute 
  for you seeking independent legal advice.**

  If you continue, you accept these terms.
buttons:
  - "I accept and want to continue": continue
  - "I do not accept": exit
---
# This code block drives the interview. It determines whether the initial
# eligibility requirements have been met and if they are directs the user # to the 'eligible' endpoint. Otherwise, it directs the user to the 
# 'ineligible' endpoint. Each endpoint displays an exit screen
# For the purposes of this exercise, a user is eligible to continue if they
# are between 18 and 65 and are an Australian citizen.
# Note: This code block must be mandatory.
mandatory: True 
code: |
  if MJFage_ok and MJFis_citizen == 'Yes':
    endpoint['eligible']
  else:
    endpoint['ineligible']
---
# This question block asks the questions to drive the code block above.
question: Personal details
fields: 
  - What is your age?: MJFage
    datatype: integer
  - Are you an Australian Citizen?: MJFis_citizen
    datatype: radio
    choices:
      - Yes
      - No
---
# This code block works out MJFage_ok
code: |
  if 18 <= MJFage < 65:
    MJFage_ok = True
  else:
    MJFage_ok = False
---
# This is the ineligible endpoint
event: endpoint['ineligible']
question: Eligibility requirements not met
subquestion:
  It appears you do not meet our eligibility requirements. You cannot use
  this service.

  Please contact bla bla bla for more assistance
buttons:
  - Exit: exit
  - Restart: restart
---
# This is the eligible endpoint.
event: endpoint['eligible']
question: You are eligible
subquestion: |
  Congratulations, you meet our
  eligibility requirements.

  Please contact bla bla bla 
  for more assistance
buttons:
  - Exit: exit
  - Restart: restart
---
```

Let's talk about this program in a little more depth. We have a question block at line 6 and a code block starting at line 23. However, we are doing a few things a little differently than in previous programs.

First, we are using a lot of comments. Commenting is good practice, and helps explain to anyone else who might be reading your code how it works.

Second, the question block at line 6 does not define any variables. Instead, this question block serves as an opening screen. It explains what the application does, and also includes a Disclaimer. Depending on what your application does, you should include a disclaimer. Sometimes you might be handling personal information submitted by your user. In this case, you will need to explain to the user that you are in compliance with privacy law. Alternatively, if your app provides legal information, you will need to clearly explain that you are not providing *legal advice*. After all, that's something only lawyers can do.

Third, we have replaced the restart button with a **continue** button. The continue button tells Docassemble to move onto the next mandatory block, which in this case is the code block at line 23.

The mandatory code block tests the values of `MJFage_ok` and `MJFis_citizen`. Note the notation of the test for `MJFage_ok` here. This notation has the same meaning as if we were to write `MJFage_ok == True`. We use this test because, if you scroll down to the if statement on lines 51 to 53, you will see that `MJFage_ok` is only ever set to one of two values - `True` or `False`. 

Note that we have also used the same notation for `MJFage_ok` in the if statement on line 32. Compare that to the test we have used for `MJFis_citizen`. `MJFis_citizen` is **not** a boolean variable. It is a string variable, and is only ever set to the string 'Yes' or `No`. Therefore, we need to modify our equality test to evaluate the contents of the variable. 

## Implementing Two Endpoints

What happens if our code meets both eligibility tests? We hit the code `endpoint['eligible']` on line 32. What does this do? Let's go back up to line 2. You can see that we have defined an `objects` block, and as part of this objects block we have defined a `DADict`. A `DADict` is what we call an **object** in programming terms. An object has certain properties that can be used to perform certain functions in an application. Here, we want to use `endpoint` to store endpoints. For this example, we have just two endpoints - `eligible` and `ineligible`. 

To trigger our endpoint, we need to match it up with an `event` tag. This event tag will tell a particular codeblock to run. You can see that we have two `event` tags - one on line 56 and one on line 68. If we meet the condition in the if statement on line 31, our application will execute the `eligible` endpoint by calling that endpoint on line 32. Otherwise, our application will execute the `ineligible` endpoint on line 34. Make sure you run through the application and see how it works. 

## Implementing Multiple Question Blocks at an Endpoint

For both the ``eligible`` and ``ineligible`` endpoints, we have implemented a **Restart** button, which restarts our application, and an **Exit** button, which allows us to quit Docassemble. 

However, we might want to introduce some screens after our endpoint screens. For example, if we are working with a non-for-profit, they might want to run a survey to see who is accessing their services. We can modify our code to achieve this.

```yaml title="C3_01_multiple_endpoints.yml" showLineNumbers
# Basic demonstration of using multiple endpoints for an interview
---
objects:
  - endpoint: DADict
---
# This is our welcome screen. We can choose to exit here 
# if we don't accept the disclaimer.
mandatory: True 
question: Welcome!
subquestion: |
  Welcome to our service (we don't know what it is yet). We hope you enjoy
  using it!

  ***Disclaimer:***
  **This advice is not to be taken as genuine legal advice and is not a substitute 
  for you seeking independent legal advice.**

  If you continue, you accept these terms.
buttons:
  - "I accept and want to continue": continue
  - "I do not accept": exit
# This was the eligible endpoint but now it's just a screen called
# on the way to the endpoint. We use a 'Continue button label' to call this
# screen.
question: Result of main program
subquestion: |
  The final report for whatever you are determining (such as eligibility for the NDIS
  or the SACAT stay application or the relative homelessness service) will be
  constructed in this subquiestion field in your eligible endpoint. By adding
  variables and if statements into this field, you will drive the main body of
  your application.
continue button field: MJFmain_program_result
---
```

## Implementing Multiple Endpoints

The style of app that we have developed works well for scenarios where there are only one of two options. What happens if we want to implement multiple endpoints, rather than just eligible or ineligible? We might want to ask multiple questions that take a user through to more than two different endpoints. In the next section of this chapter, we will walk through how to implement an app with multiple endpoints.

:::